以下是针对 **Windows CMD 环境**的通用敏感文件处理流程，专门优化了中文路径和特殊字符处理，每一步都包含详细注释说明：


1. **查看文件路径** ：

```batch
   REM 查找历史中的文件（应无输出）
   git log --name-only --oneline | findstr /i "敏感词"

   REM 检查文件是否存在（应无输出）
   git ls-files | findstr /i "文件名"
```


```batch
@echo off
REM =====================================================
REM 敏感文件清理通用流程 (Windows CMD)
REM 特别注意：此流程专为中文路径/特殊字符优化
REM =====================================================

REM 步骤 1: 安装必要工具（只需执行一次）
REM ----------------------------------------
REM 安装Python和git-filter-repo工具
python -m pip install git-filter-repo

REM 步骤 2: 进入项目目录
REM ----------------------------------------
REM 替换为您的实际项目路径
cd /d "D:\idea\code\Markdown\JavaWeb基础\教学管理系统-后端"

REM 步骤 3: 永久删除文件历史
REM ----------------------------------------
REM 使用通配符匹配中文文件名，解决大小写/编码问题
REM 关键参数：
REM   --path: 使用正斜杠和通配符处理中文路径
REM   --invert-paths: 删除匹配的文件
REM   --force: 强制操作
git filter-repo --path "教学管理系统-后端/09.文件上传.m*" --invert-paths --force

REM 步骤 4: 清理远程引用
REM ----------------------------------------
REM 删除旧的远程引用，确保完全清除历史痕迹
git push origin --delete refs/original/*

REM 步骤 5: 强制推送所有分支
REM ----------------------------------------
REM 覆盖远程仓库的所有分支（必须使用--force）
git push origin --force --all

REM 步骤 6: 强制推送所有标签
REM ----------------------------------------
REM 覆盖远程仓库的所有标签（重要！）
git push origin --force --tags

REM 步骤 7: 深度清理本地缓存
REM ----------------------------------------
REM 确保本地仓库完全清理
git reflog expire --expire=now --all
git gc --prune=now --aggressive

REM 步骤 8: 验证清理结果
REM ----------------------------------------
REM 检查历史记录中是否还有目标文件（应无输出）
git log --all --name-only --oneline | findstr "文件上传"

REM 检查当前文件系统是否还有该文件（应无输出）
git ls-files | findstr /i "文件上传"

REM =====================================================
REM 后续必要操作
REM =====================================================

REM 1. 立即撤销泄露的密钥
REM    - 登录相关云服务平台
REM    - 吊销旧密钥
REM    - 生成新密钥

REM 2. 添加防护措施
REM 创建.gitignore文件防止再次提交
echo # 敏感文件防护 > .gitignore
echo *accesskey* >> .gitignore
echo *.env >> .gitignore
echo *.secret* >> .gitignore
echo /config/* >> .gitignore
echo /credentials/* >> .gitignore

REM 提交防护规则
git add .gitignore
git commit -m "添加敏感文件防护规则"
git push

REM 3. 通知协作者
REM    - 要求所有协作者删除本地仓库
REM    - 重新克隆最新版本
```

### 关键操作说明（CMD 环境特别注意事项）：

1. **中文路径处理** ：

```batch
   REM 使用正斜杠和通配符处理中文路径
   git filter-repo --path "目录名/文件名.*" --invert-paths
```

1. **大小写敏感问题** ：

```batch
   REM 使用通配符解决扩展名大小写问题
   git filter-repo --path "目录名/文件名.m*" --invert-paths
```

1. **特殊字符处理** ：

```batch
   REM 文件名包含空格时使用引号包裹
   git filter-repo --path "目录名/文 件 名.txt" --invert-paths
```

1. **多文件处理** ：

```batch
   REM 删除多个文件使用多个--path参数
   git filter-repo ^
     --path "目录/文件1.*" ^
     --path "目录/文件2.*" ^
     --invert-paths
```

### 常见问题解决方案（CMD 环境）：

```batch
REM 问题1: git-filter-repo 未安装
python -m pip install git-filter-repo

REM 问题2: 文件名包含特殊字符
REM 使用短文件名（8.3格式）替代
dir /x
git filter-repo --path "目录名/短文件名.*" --invert-paths

REM 问题3: 推送权限不足 
REM 生成新SSH密钥并添加到GitHub
ssh-keygen -t ed25519 -C "your_email@example.com"
type %userprofile%\.ssh\id_ed25519.pub | clip

REM 问题4: 清理后GitHub仍显示文件
REM 等待30分钟并清除浏览器缓存
REM 访问时添加随机参数：https://github.com/...?t=12345
```
